const BASE_URL=window.location.origin+"/";let maxFileSize=2;$(document).ready(function(){$(".close_error_modal").on("click",CloseErrorModal)});const CloseErrorModal=()=>{$(".overlay, .server-message").hide();$(".overlay, .server-success-message").hide();if(window.location.pathname==="/"){$("#source").select()}};const downloadTextFile=(text)=>{if(text!=""){const blob=new Blob([text],{type:"text/plain"});const url=URL.createObjectURL(blob);const a=$("<a>").attr("href",url).attr("download","minifier.txt").appendTo("body");a[0].click();a.remove()}else{showError("There is no text to Download!")}};const downloadAsFile=(text,filename="minifier.txt")=>{if(text!=""){const blob=new Blob([text],{type:"text/plain"});const url=URL.createObjectURL(blob);const a=$("<a>").attr("href",url).attr("download",filename).appendTo("body");a[0].click();a.remove()}else{showError("There is no text to Download!")}};const downloadHTMLFile=(html)=>{if(html!=""){const blob=new Blob([html],{type:"text/html"});const url=URL.createObjectURL(blob);const a=$("<a>").attr("href",url).attr("download","minifier.html").appendTo("body");a[0].click();a.remove()}else{showError("There is no HTML to Download!")}};function CopyToClipboard(text){const tempTextarea=document.createElement("textarea");tempTextarea.value=text;document.body.appendChild(tempTextarea);tempTextarea.select();try{document.execCommand("copy");const copyButton=document.getElementById("copyButton");if(copyButton){copyButton.setAttribute("data-tooltip","Copied");setTimeout(function(){copyButton.setAttribute("data-tooltip","Copy")},3000)}else{showAlert("success","Content copied to clipboard")}}catch(err){console.error("Error copying to clipboard:",err);showAlert("danger","Failed to copy")}
document.body.removeChild(tempTextarea)}
const isValidUrl=(string)=>{try{const url=new URL(string);return/^https?:\/\//.test(url.href)}catch(error){return!1}};const showError=(heading="Error",message="An unknown error occurred")=>{$(".overlay").show();$(".server-message").css("display","flex");$("#error").text(message).show();$("#error-heading").text(heading).show()};const showSuccess=(heading="Success",message="Code Generated Successfully")=>{$(".overlay").show();$(".server-success-message").css("display","flex");$("#success").text(message).show();$("#success-heading").text(heading).show()};const discardErrorSuccess=()=>{$("#types").removeClass("error");$("#error").css("display","none");$("#success").css("display","none")};document.body.addEventListener("click",(e)=>{if(e.target.classList.contains("overlay")){CloseErrorModal()}});$(document).on("keydown",function(e){if(e.key==="Escape"||e.keyCode===27){CloseErrorModal()}});const showActionBtns=()=>{$(".action-btns").removeClass("visibility-hidden")};const hideActionBtns=()=>{$(".action-btns").addClass("visibility-hidden")};const readContentFromURL=async(url)=>{return new Promise((resolve,reject)=>{$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="_token"]').attr("content"),},});$.ajax({type:"POST",url:BASE_URL+"ajax/read-file",data:{url,e_track_key:getETrackKey(),},success:function(response){resolve(response)},error:function(error){reject(error)},})})};const bytesToMB=(bytes)=>{return(bytes/(1024*1024)).toFixed(2)};function jsSwap(e,input=null){e.preventDefault();const href=$(e.currentTarget).attr("href");const content=$(input).val()||$(".js-converted-value").text().trim();if(content&&href){localStorage.setItem("swapColorVal",content);window.open(href,"_blank")}}
var content=localStorage.getItem("swapColorVal");if(content){$(".js-color-input").each(function(){if($(this).is("div")){$(this).text(content)}else{$(this).val(content)}
$(this).trigger("input");setTimeout(()=>{$(".js-convert-btn").trigger("click")},300)});localStorage.removeItem("swapColorVal")}
const langValidation=(lang)=>{const languageKeywords={ActionScript:["var","function","class","if","else","return","new","package","import",],Ada:["procedure","begin","end","declare","if","then","else","return","type",],Assembly:["mov","add","sub","jmp","cmp","call","push","pop","ret","int",],C:["#include","int","char","return","void","printf","scanf","main","if","else",],"C++":["#include","std","cin","cout","class","public","private","protected","virtual","new",],COBOL:["IDENTIFICATION","DIVISION","PROGRAM-ID","DATA","SECTION","IF","ELSE","MOVE","COMPUTE",],Clojure:["def","let","if","do","fn","loop","recur","namespace","require",],CoffeeScript:["->","=>","class","if","else","return","for","while","switch","case",],Crystal:["def","class","module","if","else","elsif","return","require","new",],Csharp:["using","namespace","class","public","private","protected","void","return","new","if","else",],Dart:["import","class","if","else","void","final","const","return","new","for",],Elixir:["defmodule","def","if","else","case","do","end","alias","import",],Elm:["module","import","let","in","if","then","else","case","of",],Erlang:["-module","-export","if","case","receive","fun","begin","end","record",],Fortran:["PROGRAM","END","IF","THEN","ELSE","DO","CALL","RETURN","SUBROUTINE",],Fsharp:["let","if","else","match","with","type","module","open","return","yield",],Golang:["package","import","func","if","else","return","for","struct","type",],Groovy:["class","def","if","else","return","for","while","try","catch",],Haskell:["module","import","if","then","else","case","of","data","type",],Haxe:["class","function","if","else","return","for","while","var","new",],Java:["class","public","private","protected","static","void","int","return","new","if","else",],JavaScript:["function","var","let","const","class","if","else","return","import","export","for",],Julia:["function","if","else","return","for","while","import","export","module",],Kotlin:["fun","class","val","var","if","else","when","return","import","new",],Lisp:["defun","if","let","cond","lambda","set","setq","return"],Lua:["function","if","then","else","elseif","end","return","local","for","while",],Matlab:["function","end","if","else","elseif","for","while","return","disp",],OCaml:["let","if","else","match","with","type","module","open","rec",],Objective_C:["@interface","@implementation","@end","if","else","return","self","#import",],PHP:["<?php","echo","return","if","else","class","$","array","new","->",],Pascal:["program","begin","end","if","then","else","procedure","function","var",],Perl:["use","my","sub","if","else","elsif","return","while","foreach","package",],Pyspark:["from","import","def","if","else","return","spark","dataframe","lambda",],Python:["def","lambda","import","from","return","if","elif","else","while","for",],R:["if","else","for","while","function","return","library","require","data.frame",],Racket:["define","lambda","if","cond","begin","module","provide","require","return",],Ruby:["def","class","if","else","elsif","end","return","require","module",],Rust:["fn","let","mut","if","else","match","return","struct","enum","impl",],SAS:["data","proc","run","if","else","merge","input","set","output",],Scala:["object","class","def","val","var","if","else","match","case","return",],Scheme:["define","lambda","if","cond","begin","let","set!","return",],Swift:["class","func","if","else","return","let","var","import","for","while",],Tcl:["proc","if","else","while","for","foreach","return","global","set",],TypeScript:["function","let","const","class","if","else","return","import","export",],"VB.NET":["Dim","If","Then","Else","End","Function","Sub","Return","For","While",],Vala:["using","class","public","private","static","void","int","return","new",],};if(!languageKeywords[lang]){return!1}
const pattern=new RegExp(`\\b(${languageKeywords[lang].join("|")})\\b`);return pattern};document.addEventListener("DOMContentLoaded",function(){var x,i,j,l,ll,selElmnt,a,b,c;x=document.getElementsByClassName("custom-select");l=x.length;for(i=0;i<l;i++){selElmnt=x[i].getElementsByTagName("select")[0];ll=selElmnt.length;a=document.createElement("DIV");a.setAttribute("class","select-selected");a.innerHTML=selElmnt.options[selElmnt.selectedIndex].innerHTML;x[i].appendChild(a);b=document.createElement("DIV");b.setAttribute("class","select-items");for(j=0;j<ll;j++){c=document.createElement("DIV");c.innerHTML=selElmnt.options[j].innerHTML;c.addEventListener("click",function(e){var y,i,k,s,h,sl,yl;s=this.parentNode.parentNode.getElementsByTagName("select")[0];sl=s.length;h=this.parentNode.previousSibling;for(i=0;i<sl;i++){if(s.options[i].innerHTML==this.innerHTML){s.selectedIndex=i;h.innerHTML=this.innerHTML;y=this.parentNode.getElementsByClassName("same-as-selected");yl=y.length;for(k=0;k<yl;k++){y[k].removeAttribute("class")}
this.setAttribute("class","same-as-selected");break}}
h.click()});b.appendChild(c)}
x[i].appendChild(b);a.addEventListener("click",function(e){e.stopPropagation();closeAllSelect(this);this.nextSibling.style.display=this.nextSibling.style.display==="block"?"none":"block";this.classList.toggle("select-arrow-active")})}
function closeAllSelect(elmnt){var x,y,i,xl,yl,arrNo=[];x=document.getElementsByClassName("select-items");y=document.getElementsByClassName("select-selected");xl=x.length;yl=y.length;for(i=0;i<yl;i++){if(elmnt==y[i]){arrNo.push(i)}else{y[i].classList.remove("select-arrow-active")}}
for(i=0;i<xl;i++){if(arrNo.indexOf(i)){x[i].style.display="none"}}}
document.addEventListener("click",closeAllSelect)});$(".js-clear").on("click",function(e){clearInput(e);hideActionBtns()});function clearInput(e){const _this=$(e.currentTarget);_this.attr("data-tooltip","Cleared!");$("#source").val("");$("#source_output").val("");setTimeout(()=>{_this.attr("data-tooltip","Clear")},2000);$(".upload-paste-btns").removeClass("d-none");$(".upload-paste-btns").show()}
function scrollCenterOrTop(screenSize,div,scrollWhere="center"){if($(window).width()<=screenSize){if(scrollWhere=="center"){var $target=$(div);var targetOffset=$target.offset().top;var targetHeight=$target.outerHeight();var windowHeight=$(window).height();var scrollPos=targetOffset-(windowHeight-targetHeight)/2;$("html, body").animate({scrollTop:scrollPos,},100)}else{$("html, body").animate({scrollTop:$(div).offset().top,},100)}}}
$(document).ready(function(){$(".paste-url").on("click",function(){$(".upload-file, .paste-url , .qr-camera").fadeOut(0,function(){$(".url-input-span").removeClass("d-none").hide().fadeIn(0,function(){setTimeout(function(){$(".url-input").focus()},0)});$(".source").css({"pointer-events":"none"})})});$(document).on("click",function(e){if(!$(e.target).closest(".url-input-span, .paste-url").length){$(".url-input-span").fadeOut(0,function(){$(this).addClass("d-none");$(".url-input").val("");$(".upload-file, .paste-url , .qr-camera").fadeIn(0);$(".source").css({"pointer-events":"auto"})})}});$("#source").on("paste",function(){if($(this).val().trim()){$(".upload-paste-btns").addClass("d-none")}})});$("#source").on("input",function(){const text=$(this).val().trim();if(text===""){$(".upload-paste-btns").removeClass("d-none").show()}else{$(".upload-paste-btns").addClass("d-none")}});const debounce=(func,wait)=>{let timeout;return function executedFunction(...args){const later=()=>{clearTimeout(timeout);func(...args)};clearTimeout(timeout);timeout=setTimeout(later,wait)}};const fetchFromLink=async(url,dataType="blob")=>{discardErrorSuccess();let inputField=$(".url-input");let originalPlaceholder=inputField.attr("placeholder");inputField.attr("placeholder","Fetching file...").prop("disabled",!0);try{if(!isValidUrl(url)){throw new Error("Invalid URL. Please provide a valid URL.")}
url=encodeURI(url);let response;try{response=await fetch(url)}catch(directFetchError){const formData=new FormData();formData.append("url",url);formData.append("_token",$('meta[name="_token"]').attr("content"));formData.append("e_track_key",getETrackKey());response=await fetch("/ajax/fetch-cross-origin-file",{method:"POST",body:formData,})}
if(!response.ok){let errorMsg="Failed to fetch file.";try{const errorData=await response.json();errorMsg=errorData.error||errorMsg}catch(e){}
throw new Error(errorMsg)}
switch(dataType){case "json":return await response.json();case "text":return await response.text();case "arrayBuffer":return await response.arrayBuffer();case "blob":default:return await response.blob()}}catch(error){throw new Error(error.message||"Error fetching file from the URL.")}finally{inputField.attr("placeholder",originalPlaceholder).prop("disabled",!1)}};function initDragDropUploader(options){const dragDropArea=$(options.dragDropSelector);const textArea=$(options.textAreaSelector);const allowedTypes=options.allowedTypes||["application/json"];const onFileRead=options.onFileRead||function(){};dragDropArea.on("dragover",function(e){e.preventDefault();e.stopPropagation();textArea.addClass("drag-over")});dragDropArea.on("dragleave",function(e){e.preventDefault();e.stopPropagation();textArea.removeClass("drag-over")});dragDropArea.on("drop",function(e){e.preventDefault();e.stopPropagation();textArea.removeClass("drag-over");const files=e.originalEvent.dataTransfer.files;if(files.length){const file=files[0];if(!isAllowedFile(file,allowedTypes)){showError("Invalid File Type!",`Allowed file types: ${allowedTypes.join(", ")}`);return}
readFileToSource(file,textArea,onFileRead);$(".upload-paste-btns").addClass("d-none")}})}
function isAllowedFile(file,allowedTypes=[]){const fileType=file.type;const fileName=file.name.toLowerCase();return allowedTypes.some((type)=>{if(type.startsWith(".")){return fileName.endsWith(type)}else{return fileType===type}})}
function isValidSQL(sql){if(typeof sql!=='string'||!sql.trim())return!1;const cleaned=sql.replace(/--.*$/gm,'').replace(/\/\*[\s\S]*?\*\//g,'').replace(/\s+/g,' ').trim();if(!cleaned)return!1;const validCommands=['CREATE TABLE','CREATE DATABASE','CREATE SCHEMA','INSERT INTO','UPDATE','DELETE FROM','SELECT','ALTER TABLE','DROP TABLE','SET ','COPY ','COMMENT ON','GRANT','REVOKE','TRUNCATE','BEGIN','COMMIT','ROLLBACK','LOCK TABLE','USE ',];const upperSql=cleaned.toUpperCase();return validCommands.some(cmd=>upperSql.includes(cmd))}
function readFileToSource(file,textArea,onFileRead){discardErrorSuccess?.();const reader=new FileReader();reader.onload=function(event){const content=event.target.result;textArea.val(content);onFileRead(content)};reader.onerror=function(){showError("File Read Error","There was a problem reading the file. Please try again.")};reader.readAsText(file)}
let selectedRating=0;$(document).ready(function(){const $feedbackModal=$("#feedbackModal");const $feedbackMessage=$("#feedback__message");const $errorFeedback=$(".errorfeedback");const $openFeedbackBtn=$("#openFeedbackBtn");$openFeedbackBtn.on("click",()=>{$(".feedback__modal__overlay").show();$feedbackModal.css("display","flex")});$("#closeFeedbackBtn").on("click",closeFeedbackModal);$(document).on("keydown",function(e){if(e.key==="Escape")closeFeedbackModal();});$(".feedback__select").on("mouseenter",function(){updateStars(parseInt($(this).attr("rating")))});$(".feedback__select").on("mouseleave",function(){updateStars(selectedRating)});$(".feedback__select").on("click",function(){selectedRating=parseInt($(this).attr("rating"));$errorFeedback.addClass("hidden").text("");updateStars(selectedRating)});$("#feedback_send").on("click",function(){if(selectedRating===0){$errorFeedback.removeClass("hidden").text("Please select a rating.");return}
const message=$feedbackMessage.val().trim();const csrfToken=$('meta[name="_token"]').attr("content");$.ajaxSetup({headers:{"X-CSRF-TOKEN":csrfToken,},});$.ajax({type:"POST",url:"/emd/feedback-send",data:{rating:selectedRating,tool_id:typeof tool_id!=="undefined"?tool_id:null,message:message,e_track_key:typeof getETrackKey==="function"?getETrackKey():"",},success:function(response){showSuccess("Thank you!","Your feedback has been submitted.");closeFeedbackModal(!0);$('.js-feedback').addClass('hidden')},error:function(xhr){if(xhr.status===429){showError("Too Many Requests","Youâ€™ve already submitted feedback. Please try again later.");closeFeedbackModal(!0)}else{showError("Error",xhr.responseJSON.message||"Something went wrong. Please try again.");closeFeedbackModal(!0)}},complete:function(){resetFeedbackForm()},})});function updateStars(rating){$(".feedback__select").each(function(){const current=parseInt($(this).attr("rating"));const img=$(this).find("img");img.attr("src",current<=rating?starFull:starEmpty)})}
function closeFeedbackModal(clear=!1){$(".feedback__modal__overlay").hide();$feedbackModal.hide();if(clear)resetFeedbackForm();}
function resetFeedbackForm(){$feedbackMessage.val("");selectedRating=0;updateStars(0);$errorFeedback.addClass("hidden").text("")}})